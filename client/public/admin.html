<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokeWorld Admin Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/admin-main.css">
    <link rel="stylesheet" href="/css/admin-components.css">
</head>
<body>
    <div class="container">
        <!-- En-t√™te -->
        <div class="header">
            <h1>
                <i class="fas fa-shield-alt"></i>
                PokeWorld Administration Panel
            </h1>
            <div class="user-info">
                <span id="currentUser">Loading...</span>
                <span class="status">MAC VERIFIED</span>
                <span id="clientInfo">IP: Loading...</span>
                <div class="real-time-indicator">
                    <div class="pulse"></div>
                    Temps r√©el
                </div>
            </div>
        </div>

        <!-- Navigation -->
       <div class="nav-tabs">
    <button class="tab-btn active" data-tab="dashboard">
        <i class="fas fa-tachometer-alt"></i> Dashboard
    </button>
    <button class="tab-btn" data-tab="players">
        <i class="fas fa-users"></i> Joueurs
    </button>
    <button class="tab-btn" data-tab="quests">
        <i class="fas fa-scroll"></i> Qu√™tes
    </button>
    <button class="tab-btn" data-tab="maps">
        <i class="fas fa-map"></i> Cartes
    </button>
    <button class="tab-btn" data-tab="npcs">
        <i class="fas fa-users-cog"></i> NPCs
    </button>
    <button class="tab-btn" data-tab="shops">
        <i class="fas fa-store"></i> Boutiques
    </button>
    <button class="tab-btn" data-tab="items">
        <i class="fas fa-cube"></i> Items
    </button>
    <button class="tab-btn" data-tab="dialogues">
        <i class="fas fa-comments"></i> Dialogues
    </button>
    <button class="tab-btn" data-tab="edit">
        <i class="fas fa-edit"></i> √âdition
    </button>
    <button class="tab-btn" data-tab="logs">
        <i class="fas fa-list"></i> Logs
    </button>
    <button class="tab-btn" data-tab="tools">
        <i class="fas fa-tools"></i> Outils
    </button>
    <button class="tab-btn" data-tab="mongodb">
        <i class="fas fa-database"></i> MongoDB
    </button>
</div>
        <!-- Panel Dashboard -->
        <div class="panel active" id="dashboard">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-chart-bar"></i> Statistiques Serveur
            </h2>
            
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <div class="stat-value" id="totalPlayers">-</div>
                    <div class="stat-label">Joueurs Total</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-value" id="activePlayers">-</div>
                    <div class="stat-label">Joueurs Actifs</div>
                </div>
                <div class="stat-card warning">
                    <div class="stat-value" id="developers">-</div>
                    <div class="stat-label">D√©veloppeurs</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-value" id="totalPokemon">-</div>
                    <div class="stat-label">Pok√©mon Poss√©d√©s</div>
                </div>
                <div class="stat-card danger">
                    <div class="stat-value" id="serverUptime">-</div>
                    <div class="stat-label">Uptime Serveur</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="memoryUsage">-</div>
                    <div class="stat-label">M√©moire Utilis√©e</div>
                </div>
            </div>

            <div style="display: flex; gap: 20px; align-items: center; margin-bottom: 25px;">
                <button class="btn btn-primary" onclick="refreshStats()">
                    <i class="fas fa-sync-alt"></i> Actualiser
                </button>
                <span id="lastUpdate" style="color: #7f8c8d; font-size: 0.9rem;">
                    Derni√®re mise √† jour: ...
                </span>
            </div>
        </div>

        <!-- Panel Joueurs -->
        <div class="panel" id="players">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-users"></i> Gestion des Joueurs
            </h2>

            <div class="search-section">
                <div class="search-bar">
                    <input type="text" class="search-input" id="playerSearch" 
                           placeholder="Rechercher par nom d'utilisateur ou email...">
                    <button class="btn btn-primary" onclick="searchPlayers()">
                        <i class="fas fa-search"></i> Rechercher
                    </button>
                    <button class="btn btn-success" onclick="loadAllPlayers()">
                        <i class="fas fa-list"></i> Tous
                    </button>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Niveau</th>
                            <th>Gold</th>
                            <th>Derni√®re Connexion</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="playersTableBody">
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #7f8c8d;">
                                Cliquez sur "Tous" pour charger la liste des joueurs
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="loading" id="playersLoading">
                <div class="spinner"></div>
                Chargement des joueurs...
            </div>
        </div>

        <!-- Panel Qu√™tes -->
        <div class="panel" id="quests">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-scroll"></i> Gestion des Qu√™tes
            </h2>

            <div style="display: flex; gap: 15px; margin-bottom: 25px; align-items: center; flex-wrap: wrap;">
                <button class="btn btn-success" onclick="createNewQuest()">
                    <i class="fas fa-plus"></i> Nouvelle Qu√™te
                </button>
                <button class="btn btn-info" onclick="loadQuests()">
                    <i class="fas fa-sync-alt"></i> Actualiser
                </button>
                <button class="btn btn-warning" onclick="reloadQuestSystem()">
                    <i class="fas fa-redo"></i> Recharger Syst√®me
                </button>
                <button class="btn btn-secondary" onclick="showBackups()">
                    <i class="fas fa-history"></i> Backups
                </button>
                <span id="questsLastUpdate" style="color: #7f8c8d; font-size: 0.9rem;">
                    Derni√®re mise √† jour: ...
                </span>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nom</th>
                            <th>Cat√©gorie</th>
                            <th>√âtapes</th>
                            <th>R√©p√©table</th>
                            <th>Auto-Complete</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="questsTableBody">
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #7f8c8d;">
                                Cliquez sur "Actualiser" pour charger les qu√™tes
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="loading" id="questsLoading">
                <div class="spinner"></div>
                Chargement des qu√™tes...
            </div>
        </div>

<!-- Panel Cartes avec Items -->
<div class="panel" id="maps">
    <div class="map-editor-container">
        <!-- Header de l'√©diteur -->
        <div class="map-toolbar">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                
                <!-- S√©lection de carte -->
                <div class="toolbar-group">
                    <label for="mapSelect" class="form-label">üó∫Ô∏è Carte:</label>
                    <select id="mapSelect" class="form-select" onchange="adminPanel.mapEditor.loadMap(this.value)" style="min-width: 200px;">
                        <option value="">Chargement...</option>
                    </select>
                </div>

                <!-- Outils de placement -->
                <div class="toolbar-group" id="mapTools" style="display: none;">
                    <span class="form-label">üõ†Ô∏è Outils:</span>
                    <button class="btn-tool active" data-tool="object" onclick="adminPanel.mapEditor.selectTool('object')">
                        üì¶ Items
                    </button>
                    <button class="btn-tool" data-tool="npc" onclick="adminPanel.mapEditor.selectTool('npc')">
                        üë§ NPC
                    </button>
                    <button class="btn-tool" data-tool="spawn" onclick="adminPanel.mapEditor.selectTool('spawn')">
                        üéØ Spawn
                    </button>
                    <button class="btn-tool" data-tool="teleport" onclick="adminPanel.mapEditor.selectTool('teleport')">
                        üåÄ T√©l√©port
                    </button>
                </div>

                
                <!-- Contr√¥les de zoom -->
                <div class="toolbar-group">
                    <label for="zoomSlider" class="form-label">üîç Zoom:</label>
                    <input type="range" id="zoomSlider" min="0.25" max="3" step="0.25" value="1" 
                           onchange="adminPanel.mapEditor.setZoom(this.value)" style="width: 100px;">
                    <span id="zoomValue" style="min-width: 40px; font-weight: bold;">100%</span>
                </div>

                <!-- Actions -->
                <div class="toolbar-group" id="mapActions" style="display: none;">
                    <button class="btn btn-success" onclick="adminPanel.mapEditor.saveMapObjects()">
                        üíæ Sauvegarder
                    </button>
                    <button class="btn btn-warning" onclick="location.reload()">
                        üîÑ Actualiser
                    </button>
                </div>
            </div>
        </div>

        <!-- Zone principale avec carte et panels -->
        <div class="map-main-area">
            
            <!-- Container du canvas -->
            <div id="mapCanvasContainer">
                <div id="mapLoadingMessage" style="text-align: center; color: #6c757d; font-size: 1.2rem;">
                    <div style="margin-bottom: 15px;">üó∫Ô∏è</div>
                    <div>S√©lectionnez une carte pour commencer</div>
                </div>
                <canvas id="mapCanvas" style="display: none;"></canvas>
            </div>

            <!-- Panel des objets et items -->
            <div id="objectsPanel" style="display: none;">
                
                <!-- Section Items -->
                <div class="panel-section">
                    <div id="itemsContainer">
                        <!-- Sera rempli dynamiquement par renderItemsPanel() -->
                        <div style="text-align: center; padding: 20px; color: #6c757d;">
                            <div style="font-size: 2rem; margin-bottom: 10px;">üì¶</div>
                            <div>Chargement des items...</div>
                        </div>
                    </div>
                </div>

                <!-- Section Objets plac√©s -->
                <div class="panel-section">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                        üéØ Objets Plac√©s 
                        <span id="objectsCount" class="badge badge-primary">0</span>
                    </h3>
                    
                    <div id="noObjectsMessage" style="text-align: center; padding: 20px; color: #6c757d; border: 2px dashed #dee2e6; border-radius: 8px;">
                        <div style="font-size: 1.5rem; margin-bottom: 8px;">üéØ</div>
                        <div style="font-weight: 600; margin-bottom: 4px;">Aucun objet plac√©</div>
                        <div style="font-size: 0.9rem;">Cliquez sur la carte pour placer des objets</div>
                    </div>
                    
                    <div id="objectsList" class="placed-objects-list">
                        <!-- Sera rempli dynamiquement par updateObjectsList() -->
                    </div>
                </div>

            </div>
        </div>

        <!-- Instructions en bas -->
        <div class="map-instructions">
            <div class="map-instructions-content">
                <div>üí° <strong>Instructions:</strong></div>
                <div>üñ±Ô∏è Clic pour placer/supprimer</div>
                <div>üì¶ S√©lectionnez un item puis cliquez</div>
                <div>üîç Utilisez le zoom pour ajuster la vue</div>
                <div>üíæ N'oubliez pas de sauvegarder !</div>
            </div>
        </div>
    </div>
</div>

        <div class="panel" id="mongodb">
    <div style="text-align: center; padding: 40px; color: #95a5a6;">
        Chargement de l'explorateur MongoDB...
    </div>
</div>
        <!-- Panel NPCs -->
<div class="panel" id="npcs">
    <h2 style="margin-bottom: 25px; color: #2c3e50;">
        <i class="fas fa-users-cog"></i> √âditeur de NPCs
    </h2>
    
    <!-- Le contenu sera g√©n√©r√© par le module JavaScript -->
    <div id="npcEditorContainer">
        <div style="text-align: center; padding: 40px; color: #95a5a6;">
            Chargement de l'√©diteur NPCs...
        </div>
    </div>
</div>
        <!-- Panel √âdition -->
        <div class="panel" id="edit">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-edit"></i> √âdition en Temps R√©el
            </h2>

            <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 10px; padding: 20px; margin-bottom: 25px;">
                <i class="fas fa-exclamation-triangle" style="color: #f39c12;"></i>
                <strong>Attention:</strong> Les modifications sont appliqu√©es imm√©diatement et de mani√®re permanente.
            </div>

            <div id="editPlayerSection" style="display: none;">
                <h3 style="margin-bottom: 20px; color: #2c3e50;">
                    √âditer: <span id="editPlayerName">-</span>
                </h3>

                <form id="editPlayerForm">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label class="form-label">Gold</label>
                            <input type="number" class="form-input" id="editGold" min="0" max="999999">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Niveau</label>
                            <input type="number" class="form-input" id="editLevel" min="1" max="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Exp√©rience</label>
                            <input type="number" class="form-input" id="editExperience" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Position X</label>
                            <input type="number" class="form-input" id="editX">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Position Y</label>
                            <input type="number" class="form-input" id="editY">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Carte</label>
                            <select class="form-select" id="editMap">
                                <option value="beach">Beach</option>
                                <option value="village">Village</option>
                                <option value="forest">Forest</option>
                                <option value="cave">Cave</option>
                            </select>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="editIsDev">
                                <span>D√©veloppeur</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="editIsActive">
                                <span>Compte Actif</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="editIsBanned">
                                <span>Banni</span>
                            </label>
                        </div>
                    </div>

                    <div style="margin-top: 30px; display: flex; gap: 15px;">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-save"></i> Sauvegarder
                        </button>
                        <button type="button" class="btn btn-secondary" onclick="cancelEdit()">
                            <i class="fas fa-times"></i> Annuler
                        </button>
                        <button type="button" class="btn btn-warning" onclick="resetPlayerData()">
                            <i class="fas fa-undo"></i> Reset Donn√©es
                        </button>
                    </div>
                </form>
            </div>

            <div id="noPlayerSelected" style="text-align: center; padding: 60px; color: #7f8c8d;">
                <i class="fas fa-user-edit" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.3;"></i>
                <p>S√©lectionnez un joueur depuis l'onglet "Joueurs" pour commencer l'√©dition</p>
            </div>
        </div>

        <div class="panel" id="shops">
    <h2 style="margin-bottom: 25px; color: #2c3e50;">
        <i class="fas fa-store"></i> √âditeur de Boutiques
    </h2>
    
    <!-- Le contenu sera g√©n√©r√© par le module JavaScript -->
    <div id="shopEditorContainer">
        <div style="text-align: center; padding: 40px; color: #95a5a6;">
            Chargement de l'√©diteur de boutiques...
        </div>
    </div>
</div>

        <div class="panel" id="dialogues">
    <h2 style="margin-bottom: 25px; color: #2c3e50;">
        <i class="fas fa-comments"></i> √âditeur de Dialogues
    </h2>
    
    <!-- Le contenu sera g√©n√©r√© par le module JavaScript -->
    <div id="dialogueEditorContainer">
        <div style="text-align: center; padding: 40px; color: #95a5a6;">
            Chargement de l'√©diteur de dialogues...
        </div>
    </div>
</div>

<!-- Panel Items - VERSION CORRIG√âE avec type="button" -->
<div class="panel" id="items">
    <div class="item-editor-container">
        
        <!-- Header avec filtres et actions -->
        <div class="item-editor-header">
            <div class="item-editor-header-controls">
                <div class="item-editor-filters-group">
                    <div class="item-editor-filter-item">
                        <label class="form-label">Recherche</label>
                        <input 
                            type="text" 
                            id="itemSearch" 
                            class="item-editor-search-input" 
                            placeholder="Rechercher un item..."
                        />
                    </div>
                    
                    <div class="item-editor-filter-item">
                        <label class="form-label">Cat√©gorie</label>
                        <select id="itemCategoryFilter" class="item-editor-form-select">
                            <option value="all">Toutes cat√©gories</option>
                            <option value="medicine">M√©decine</option>
                            <option value="pokeballs">Pok√©balls</option>
                            <option value="battle_items">Combat</option>
                            <option value="key_items">Objets Cl√©s</option>
                            <option value="berries">Baies</option>
                            <option value="machines">CT/CS</option>
                            <option value="evolution_items">√âvolution</option>
                            <option value="held_items">Objets Tenus</option>
                            <option value="treasure">Tr√©sors</option>
                        </select>
                    </div>
                    
                    <div class="item-editor-filter-item">
                        <label class="form-label">G√©n√©ration</label>
                        <select id="itemGenerationFilter" class="item-editor-form-select">
                            <option value="all">Toutes g√©n√©rations</option>
                            <option value="1">G√©n√©ration I</option>
                            <option value="2">G√©n√©ration II</option>
                            <option value="3">G√©n√©ration III</option>
                            <option value="4">G√©n√©ration IV</option>
                            <option value="5">G√©n√©ration V</option>
                        </select>
                    </div>
                    
                    <div class="item-editor-filter-item">
                        <label class="form-label">Raret√©</label>
                        <select id="itemRarityFilter" class="item-editor-form-select">
                            <option value="all">Toutes raret√©s</option>
                            <option value="common">Commun</option>
                            <option value="uncommon">Peu commun</option>
                            <option value="rare">Rare</option>
                            <option value="epic">√âpique</option>
                            <option value="legendary">L√©gendaire</option>
                            <option value="mythic">Mythique</option>
                        </select>
                    </div>
                </div>
                
                <div class="item-editor-header-actions">
                    <button type="button" class="item-editor-btn item-editor-btn-success" onclick="window.itemEditorCreateNew()">
                        <i class="fas fa-plus"></i> Nouvel Item
                    </button>
                    <button type="button" class="item-editor-btn item-editor-btn-info" onclick="window.itemEditorRefresh()">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                    <button type="button" class="item-editor-btn item-editor-btn-secondary" onclick="window.itemEditorExport()">
                        <i class="fas fa-download"></i> Exporter
                    </button>
                </div>
            </div>
            
            <!-- Stats g√©n√©rales -->
            <div class="item-editor-stats">
                <div class="item-editor-stats-row">
                    <div class="item-editor-stat-item">
                        <div class="item-editor-stat-value" id="totalItems">0</div>
                        <div class="item-editor-stat-label">Total Items</div>
                    </div>
                    <div class="item-editor-stat-item">
                        <div class="item-editor-stat-value" id="activeItems">0</div>
                        <div class="item-editor-stat-label">Actifs</div>
                    </div>
                    <div class="item-editor-stat-item">
                        <div class="item-editor-stat-value" id="categoriesCount">0</div>
                        <div class="item-editor-stat-label">Cat√©gories</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Zone principale -->
        <div class="item-editor-main-area">
            
            <!-- Panel liste des items -->
            <div class="item-editor-list-panel">
                <div class="item-editor-list-header">
                    <h3>Liste des Items</h3>
                </div>
                
                <div class="item-editor-list-container">
                    <!-- Loading -->
                    <div class="item-editor-loading" id="itemsLoading" style="display: none;">
                        <i class="fas fa-spinner fa-spin"></i>
                        Chargement des items...
                    </div>
                    
                    <!-- Liste des items -->
                    <div id="itemsList">
                        <!-- Items seront inject√©s ici par JS -->
                    </div>
                </div>
                
                <!-- Pagination -->
                <div class="item-editor-list-footer">
                    <div class="item-editor-page-info" id="itemsPaginationInfo">
                        0-0 sur 0 items
                    </div>
                    <div class="item-editor-pagination">
                        <button type="button" class="item-editor-page-btn" id="itemsPrevBtn" onclick="window.itemEditorPreviousPage()">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span id="itemsPageInfo">1 / 1</span>
                        <button type="button" class="item-editor-page-btn" id="itemsNextBtn" onclick="window.itemEditorNextPage()">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Panel √©diteur -->
            <div class="item-editor-panel">
                <div class="item-editor-panel-header">
                    <h2 class="item-editor-panel-title" id="itemEditorTitle">
                        <i class="fas fa-cube"></i> S√©lectionnez un item
                    </h2>
                    
                    <div class="item-editor-panel-actions" id="itemEditorActions" style="display: none;">
                        <button type="button" class="item-editor-btn item-editor-btn-success" id="saveItemBtn" onclick="window.itemEditorSave()" disabled>
                            <i class="fas fa-save"></i> Enregistrer
                        </button>
                        <button type="button" class="item-editor-btn item-editor-btn-warning" onclick="window.itemEditorDuplicate()">
                            <i class="fas fa-copy"></i> Dupliquer
                        </button>
                        <button type="button" class="item-editor-btn item-editor-btn-secondary" onclick="window.itemEditorCancel()">
                            <i class="fas fa-times"></i> Annuler
                        </button>
                        <button type="button" class="item-editor-btn item-editor-btn-danger" onclick="window.itemEditorDelete()">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                    </div>
                </div>
                
                <div class="item-editor-panel-content">
                    <!-- √âtat vide -->
                    <div class="item-editor__empty-state" id="itemEditorEmpty">
                        <div class="item-editor__empty-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <h3 class="item-editor__empty-title">Aucun item s√©lectionn√©</h3>
                        <p class="item-editor__empty-subtitle">
                            Choisissez un item dans la liste ou cr√©ez-en un nouveau pour commencer l'√©dition.
                        </p>
                        <button type="button" class="item-editor-btn item-editor-btn-primary" onclick="window.itemEditorCreateNew()">
                            <i class="fas fa-plus"></i> Cr√©er un nouvel item
                        </button>
                    </div>
                    
                    <!-- Formulaire d'√©dition -->
                    <form class="item-editor-form" id="itemEditorForm" style="display: none;" autocomplete="off" onsubmit="return false;">
                        
                        <!-- Section Informations de base -->
                        <div class="item-editor-form-section">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-info-circle"></i>
                                    Informations de base
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div class="item-editor-fields-grid">
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">
                                            ID de l'item 
                                            <span class="item-editor-field-required">*</span>
                                        </label>
                                        <input 
                                            type="text" 
                                            id="itemId" 
                                            name="itemId"
                                            class="item-editor-form-input"
                                            placeholder="ex: potion"
                                            required
                                            autocomplete="off"
                                        />
                                        <div class="item-editor-field-help">
                                            Identifiant unique (lettres minuscules, chiffres, tirets et underscores uniquement)
                                        </div>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">
                                            Nom affich√©
                                            <span class="item-editor-field-required">*</span>
                                        </label>
                                        <input 
                                            type="text" 
                                            id="itemName" 
                                            name="name"
                                            class="item-editor-form-input"
                                            placeholder="ex: Potion"
                                            required
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">
                                            Cat√©gorie
                                            <span class="item-editor-field-required">*</span>
                                        </label>
                                        <select id="itemCategory" name="category" class="item-editor-form-select" required>
                                            <option value="">S√©lectionnez...</option>
                                            <option value="medicine">M√©decine</option>
                                            <option value="pokeballs">Pok√©balls</option>
                                            <option value="battle_items">Objets de Combat</option>
                                            <option value="key_items">Objets Cl√©s</option>
                                            <option value="berries">Baies</option>
                                            <option value="machines">CT/CS</option>
                                            <option value="evolution_items">Objets d'√âvolution</option>
                                            <option value="held_items">Objets Tenus</option>
                                            <option value="treasure">Tr√©sors</option>
                                        </select>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">G√©n√©ration</label>
                                        <select id="itemGeneration" name="generation" class="item-editor-form-select">
                                            <option value="1">G√©n√©ration I</option>
                                            <option value="2">G√©n√©ration II</option>
                                            <option value="3">G√©n√©ration III</option>
                                            <option value="4">G√©n√©ration IV</option>
                                            <option value="5">G√©n√©ration V</option>
                                        </select>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Raret√©</label>
                                        <select id="itemRarity" name="rarity" class="item-editor-form-select">
                                            <option value="common">Commun</option>
                                            <option value="uncommon">Peu commun</option>
                                            <option value="rare">Rare</option>
                                            <option value="epic">√âpique</option>
                                            <option value="legendary">L√©gendaire</option>
                                            <option value="mythic">Mythique</option>
                                        </select>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Sprite/Ic√¥ne</label>
                                        <input 
                                            type="text" 
                                            id="itemSprite" 
                                            name="sprite"
                                            class="item-editor-form-input"
                                            placeholder="ex: potion.png"
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Tags</label>
                                        <input 
                                            type="text" 
                                            id="itemTags" 
                                            name="tags"
                                            class="item-editor-form-input"
                                            placeholder="tag1, tag2, tag3"
                                            autocomplete="off"
                                        />
                                        <div class="item-editor-field-help">S√©parez les tags par des virgules</div>
                                    </div>
                                </div>
                                
                                <div class="item-editor-form-field">
                                    <label class="item-editor-field-label">
                                        Description
                                        <span class="item-editor-field-required">*</span>
                                    </label>
                                    <textarea 
                                        id="itemDescription" 
                                        name="description"
                                        class="item-editor-form-textarea"
                                        placeholder="Description d√©taill√©e de l'item..."
                                        required
                                    ></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section √âconomie -->
                        <div class="item-editor-form-section">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-coins"></i>
                                    √âconomie
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div class="item-editor-fields-grid">
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Prix d'achat (‚ÇΩ)</label>
                                        <input 
                                            type="number" 
                                            id="itemPrice" 
                                            name="price"
                                            class="item-editor-form-input"
                                            min="0"
                                            placeholder="0 = gratuit"
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Prix de vente (‚ÇΩ)</label>
                                        <input 
                                            type="number" 
                                            id="itemSellPrice" 
                                            name="sellPrice"
                                            class="item-editor-form-input"
                                            min="0"
                                            placeholder="Auto = prix d'achat / 2"
                                            autocomplete="off"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section Propri√©t√©s -->
                        <div class="item-editor-form-section">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-cogs"></i>
                                    Propri√©t√©s et Restrictions
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div class="item-editor-fields-grid">
                                    <div class="item-editor-form-field">
                                        <div class="item-editor-boolean-field">
                                            <input 
                                                type="checkbox" 
                                                id="itemStackable" 
                                                name="stackable"
                                                class="item-editor-form-checkbox"
                                                checked
                                            />
                                            <label for="itemStackable" class="item-editor-checkbox-label">
                                                Item empilable
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <div class="item-editor-boolean-field">
                                            <input 
                                                type="checkbox" 
                                                id="itemConsumable" 
                                                name="consumable"
                                                class="item-editor-form-checkbox"
                                                checked
                                            />
                                            <label for="itemConsumable" class="item-editor-checkbox-label">
                                                Item consommable
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <div class="item-editor-boolean-field">
                                            <input 
                                                type="checkbox" 
                                                id="itemBattleOnly" 
                                                name="battleOnly"
                                                class="item-editor-form-checkbox"
                                            />
                                            <label for="itemBattleOnly" class="item-editor-checkbox-label">
                                                Utilisable en combat uniquement
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <div class="item-editor-boolean-field">
                                            <input 
                                                type="checkbox" 
                                                id="itemFieldOnly" 
                                                name="fieldOnly"
                                                class="item-editor-form-checkbox"
                                            />
                                            <label for="itemFieldOnly" class="item-editor-checkbox-label">
                                                Utilisable hors combat uniquement
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Niveau requis</label>
                                        <input 
                                            type="number" 
                                            id="itemLevelRequirement" 
                                            name="levelRequirement"
                                            class="item-editor-form-input"
                                            min="1"
                                            max="100"
                                            placeholder="Aucune restriction"
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Restrictions g√©ographiques</label>
                                        <input 
                                            type="text" 
                                            id="itemLocationRestrictions" 
                                            name="locationRestrictions"
                                            class="item-editor-form-input"
                                            placeholder="zone1, zone2, zone3"
                                            autocomplete="off"
                                        />
                                        <div class="item-editor-field-help">Zones o√π l'item peut √™tre utilis√© (optionnel)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section Effets -->
                        <div class="item-editor-form-section">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-magic"></i>
                                    Effets
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <p class="item-editor-field-help">D√©finissez les effets de cet item lors de son utilisation.</p>
                                    <button type="button" class="item-editor-btn item-editor-btn-sm item-editor-btn-primary" onclick="window.itemEditorAddEffect()">
                                        <i class="fas fa-plus"></i> Ajouter Effet
                                    </button>
                                </div>
                                <div id="itemEffectsList" class="item-editor-dynamic-list">
                                    <!-- Effets seront ajout√©s dynamiquement ici -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section M√©thodes d'obtention -->
                        <div class="item-editor-form-section">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-map-marker-alt"></i>
                                    M√©thodes d'obtention
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-down"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <p class="item-editor-field-help">Comment les joueurs peuvent obtenir cet item.</p>
                                    <button type="button" class="item-editor-btn item-editor-btn-sm item-editor-btn-primary" onclick="window.itemEditorAddObtainMethod()">
                                        <i class="fas fa-plus"></i> Ajouter M√©thode
                                    </button>
                                </div>
                                <div id="itemObtainMethodsList" class="item-editor-dynamic-list">
                                    <!-- M√©thodes d'obtention seront ajout√©es dynamiquement ici -->
                                </div>
                            </div>
                        </div>
                        
                        <!-- Section M√©tadonn√©es -->
                        <div class="item-editor-form-section collapsed">
                            <div class="item-editor-section-header" onclick="toggleSection(this)">
                                <h4 class="item-editor-section-title">
                                    <i class="fas fa-info"></i>
                                    M√©tadonn√©es
                                </h4>
                                <span class="item-editor-section-toggle">
                                    <i class="fas fa-chevron-right"></i>
                                </span>
                            </div>
                            <div class="item-editor-section-content">
                                <div class="item-editor-fields-grid">
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Version</label>
                                        <input 
                                            type="text" 
                                            id="itemVersion" 
                                            name="version"
                                            class="item-editor-form-input"
                                            placeholder="2.0.0"
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <label class="item-editor-field-label">Fichier source</label>
                                        <input 
                                            type="text" 
                                            id="itemSourceFile" 
                                            name="sourceFile"
                                            class="item-editor-form-input"
                                            placeholder="admin_editor"
                                            autocomplete="off"
                                        />
                                    </div>
                                    
                                    <div class="item-editor-form-field">
                                        <div class="item-editor-boolean-field">
                                            <input 
                                                type="checkbox" 
                                                id="itemIsActive" 
                                                name="isActive"
                                                class="item-editor-form-checkbox"
                                                checked
                                            />
                                            <label for="itemIsActive" class="item-editor-checkbox-label">
                                                Item actif dans le jeu
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </form>
                </div>
            </div>
            
        </div>
    </div>
</div>

    
        <!-- Panel Logs -->
        <div class="panel" id="logs">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-list"></i> Logs Syst√®me
            </h2>

            <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: center; flex-wrap: wrap;">
                <select class="form-select" id="logType" style="width: auto;">
                    <option value="all">Tous les logs</option>
                    <option value="auth">Authentification</option>
                    <option value="game">Jeu</option>
                    <option value="database">Base de donn√©es</option>
                    <option value="error">Erreurs</option>
                </select>
                <button class="btn btn-primary" onclick="loadLogs()">
                    <i class="fas fa-sync-alt"></i> Actualiser
                </button>
                <button class="btn btn-secondary" onclick="clearLogs()">
                    <i class="fas fa-trash"></i> Vider
                </button>
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" id="autoRefreshLogs" onchange="toggleAutoRefresh()">
                    <span>Auto-actualisation (5s)</span>
                </label>
            </div>

            <div class="logs-container" id="logsContainer">
                <div style="text-align: center; padding: 40px; color: #95a5a6;">
                    Cliquez sur "Actualiser" pour charger les logs
                </div>
            </div>
        </div>

        <!-- Panel Outils -->
        <div class="panel" id="tools">
            <h2 style="margin-bottom: 25px; color: #2c3e50;">
                <i class="fas fa-tools"></i> Outils d'Administration
            </h2>

            <div class="tools-grid">
                <div class="tool-card">
                    <h3>
                        <i class="fas fa-users-cog"></i> Actions en Lot
                    </h3>
                    <p>Effectuer des actions sur plusieurs joueurs simultan√©ment.</p>
                    <div class="form-group">
                        <label class="form-label">Utilisateurs (un par ligne)</label>
                        <textarea class="form-input" id="bulkUsers" rows="4" 
                                  placeholder="username1&#10;username2&#10;username3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Action</label>
                        <select class="form-select" id="bulkAction">
                            <option value="activate">Activer les comptes</option>
                            <option value="deactivate">D√©sactiver les comptes</option>
                            <option value="reset_gold">Reset Gold (1000)</option>
                        </select>
                    </div>
                    <button class="btn btn-warning" onclick="executeBulkAction()">
                        <i class="fas fa-bolt"></i> Ex√©cuter
                    </button>
                </div>

                <div class="tool-card">
                    <h3>
                        <i class="fas fa-database"></i> Base de Donn√©es
                    </h3>
                    <p>Outils de maintenance et statistiques DB.</p>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn btn-info" onclick="getDBStats()">
                            <i class="fas fa-chart-pie"></i> Statistiques DB
                        </button>
                        <button class="btn btn-warning" onclick="optimizeDB()">
                            <i class="fas fa-magic"></i> Optimiser DB
                        </button>
                        <button class="btn btn-secondary" onclick="backupDB()">
                            <i class="fas fa-download"></i> Backup
                        </button>
                    </div>
                </div>

                <div class="tool-card">
                    <h3>
                        <i class="fas fa-server"></i> Serveur
                    </h3>
                    <p>Contr√¥le et monitoring du serveur de jeu.</p>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn btn-success" onclick="restartGameRooms()">
                            <i class="fas fa-redo"></i> Restart Rooms
                        </button>
                        <button class="btn btn-info" onclick="getActiveConnections()">
                            <i class="fas fa-network-wired"></i> Connexions Actives
                        </button>
                        <button class="btn btn-danger" onclick="emergencyShutdown()">
                            <i class="fas fa-power-off"></i> Arr√™t d'Urgence
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour d√©tails joueur -->
    <div class="modal" id="playerModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">
                <i class="fas fa-user-circle"></i> D√©tails du Joueur
            </h3>
            <div id="playerModalContent">
                Loading...
            </div>
            <div style="margin-top: 25px; text-align: right;">
                <button class="btn btn-primary" onclick="editPlayer()">
                    <i class="fas fa-edit"></i> √âditer
                </button>
                <button class="btn btn-secondary" onclick="closeModal()">
                    <i class="fas fa-times"></i> Fermer
                </button>
            </div>
        </div>
    </div>

    <!-- Modal √âditeur de Qu√™te -->
    <div class="modal" id="questEditorModal">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh;">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">
                <i class="fas fa-edit"></i> <span id="questEditorTitle">√âditeur de Qu√™te</span>
            </h3>
            
            <form id="questEditorForm">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div class="form-group">
                        <label class="form-label">ID de la Qu√™te</label>
                        <input type="text" class="form-input" id="questId" required>
                        <div class="input-help">Identifiant unique (pas d'espaces)</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Nom</label>
                        <input type="text" class="form-input" id="questName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Cat√©gorie</label>
                        <select class="form-select" id="questCategory">
                            <option value="main">Principale</option>
                            <option value="side">Secondaire</option>
                            <option value="daily">Quotidienne</option>
                            <option value="event">√âv√©nement</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-input" id="questDescription" rows="3"></textarea>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div class="form-group">
                        <label class="form-label">NPC de D√©but</label>
                        <input type="number" class="form-input" id="questStartNpc" placeholder="ID du NPC">
                    </div>
                    <div class="form-group">
                        <label class="form-label">NPC de Fin</label>
                        <input type="number" class="form-input" id="questEndNpc" placeholder="ID du NPC">
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="questRepeatable">
                            <span>R√©p√©table</span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="questAutoComplete">
                            <span>Auto-Complete</span>
                        </label>
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                    <h4 style="margin-bottom: 15px; color: #2c3e50;">Dialogues</h4>
                    
                    <div class="form-group">
                        <label class="form-label">Dialogue d'Offre</label>
                        <textarea class="form-input" id="questDialogueOffer" rows="3" 
                                  placeholder="Une ligne par dialogue (Entr√©e pour nouvelle ligne)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Dialogue en Cours</label>
                        <textarea class="form-input" id="questDialogueProgress" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Dialogue de Fin</label>
                        <textarea class="form-input" id="questDialogueComplete" rows="3"></textarea>
                    </div>
                </div>

                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="color: #2c3e50;">√âtapes de la Qu√™te</h4>
                        <button type="button" class="btn btn-primary btn-sm" onclick="addQuestStep()">
                            <i class="fas fa-plus"></i> Ajouter √âtape
                        </button>
                    </div>
                    
                    <div id="questStepsContainer">
                        <!-- Les √©tapes seront ajout√©es dynamiquement ici -->
                    </div>
                </div>

                <div style="display: flex; gap: 15px; justify-content: flex-end;">
                    <button type="button" class="btn btn-secondary" onclick="closeQuestEditor()">
                        <i class="fas fa-times"></i> Annuler
                    </button>
                    <button type="button" class="btn btn-info" onclick="previewQuest()">
                        <i class="fas fa-eye"></i> Aper√ßu
                    </button>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> Sauvegarder
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Backups -->
    <div class="modal" id="backupsModal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; color: #2c3e50;">
                <i class="fas fa-history"></i> Backups des Qu√™tes
            </h3>
            
            <div id="backupsList">
                <!-- Liste des backups -->
            </div>
            
            <div style="margin-top: 25px; text-align: right;">
                <button class="btn btn-secondary" onclick="closeModal()">
                    <i class="fas fa-times"></i> Fermer
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="/assets/admin.js"></script>
</body>
</html>
